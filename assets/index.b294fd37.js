import{n as U,l as $,m as P,p as S,q as ce,r as y}from"./index.418e0b9f.js";import{K as B,v as Y,f as v,s as ie,E as ue,k as x,ar as ae}from"./vendor.379ae99b.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 *//**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */function de(r){return r.offsetX===0&&r.offsetY===0}function le(r){const n=r.touches&&r.touches[0]||r.changedTouches&&r.changedTouches[0];return!!n&&n.identifier===-1&&(n.radiusX==null||n.radiusX===1)&&(n.radiusY==null||n.radiusY===1)}var fe=Object.defineProperty,K=Object.getOwnPropertySymbols,_e=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable,V=(r,n,s)=>n in r?fe(r,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[n]=s,X=(r,n)=>{for(var s in n||(n={}))_e.call(n,s)&&V(r,s,n[s]);if(K)for(var s of K(n))me.call(n,s)&&V(r,s,n[s]);return r};const pe=Symbol("cdk-input-modality-detector-options"),ve={ignoreCodes:["AltLeft","AltRight","ControlLeft","ControlRight","OSLeft","OSRight","ShiftLeft","ShiftRight"]},G=650,h=U({passive:!0,capture:!0});function he(r){const n=B(pe,ve),s=X(X({},n),r),l=x(null),O=v(()=>l.value),d=i=>{l.value=i,ae(O)},a=x(null);let f=0;const _=i=>{var u;((u=s.ignoreCodes)==null?void 0:u.some(L=>L===i.code))||(d("keyboard"),a.value=y(i))},g=i=>{Date.now()-f<G||(d(de(i)?"keyboard":"mouse"),a.value=y(i))},m=i=>{if(le(i)){d("keyboard");return}f=Date.now(),d("touch"),a.value=y(i)};return S&&(document.addEventListener("keydown",_,h),document.addEventListener("mousedown",g,h),document.addEventListener("touchstart",m,h)),Y(()=>{S&&(document.removeEventListener("keydown",_,h),document.removeEventListener("mousedown",g,h),document.removeEventListener("touchstart",m,h))}),{modality:v(()=>l.value),modalityDetected:O,target:v(()=>a.value)}}const Oe=$(he);var ge=Object.defineProperty,q=Object.getOwnPropertySymbols,we=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable,z=(r,n,s)=>n in r?ge(r,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[n]=s,H=(r,n)=>{for(var s in n||(n={}))we.call(n,s)&&z(r,s,n[s]);if(q)for(var s of q(n))Ee.call(n,s)&&z(r,s,n[s]);return r};const Te=Symbol("cdk-focus-monitor-options"),ye={detectionMode:"immediate"},F=U({passive:!0,capture:!0});function Le(r){var n;const s=B(Te,ye),l=H(H({},s),r),O=l.detectionMode,d=(n=l.inputModalityDetector)!=null?n:Oe();let a=null,f,_=!1,g,m,i=!1;const u=new Map;let L=0;const p=new Map,C=()=>{_=!0,g=setTimeout(()=>_=!1)};let I=null;const b=t=>{const e=y(t),o=t.type==="focus"?ee:te;for(let c=e;c;c=c.parentElement)o(t,c)};function W(t,e=!1){const o=P(t);if(!S||!o||o.nodeType!==1)return v(()=>({origin:null}));const c=ce(o)||M(),E=u.get(o);if(E)return e&&(E.checkChildren=!0),v(()=>E.subject.value);const T={checkChildren:e,subject:ie({origin:null}),rootNode:c};return u.set(o,T),oe(T),v(()=>T.subject.value)}function D(t){const e=P(t);if(!e)return;const o=u.get(e);o&&(N(e),u.delete(e),ne(o))}function J(t,e,o){const c=P(t),E=M().activeElement;c===E?re(c).forEach(([T,se])=>A(T,e,se)):(R(e),c&&typeof c.focus=="function"&&c.focus(o))}function M(){return document}function k(){return M().defaultView||window}function w(t,e,o){o?t.classList.add(e):t.classList.remove(e)}function Q(t){return a?i?Z(t)?"touch":"program":a:_&&f?f:"program"}function Z(t){return O==="eventual"||!!(t==null?void 0:t.contains(d.target.value))}function N(t,e){w(t,"cdk-focused",!!e),w(t,"cdk-touch-focused",e==="touch"),w(t,"cdk-keyboard-focused",e==="keyboard"),w(t,"cdk-mouse-focused",e==="mouse"),w(t,"cdk-program-focused",e==="program")}function R(t,e=!1){a=t,i=t==="touch"&&e,O==="immediate"&&(clearTimeout(m),m=setTimeout(()=>a=null,i?G:1))}function ee(t,e){const o=u.get(e),c=y(t);!o||!o.checkChildren&&e!==c||A(e,Q(c),o,t)}function te(t,e){const o=u.get(e);!o||o.checkChildren&&t.relatedTarget instanceof Node&&e.contains(t.relatedTarget)||(N(e),j(o.subject,null,t))}function j(t,e,o){t.value={origin:e,event:o}}function oe(t){if(!S)return;const e=t.rootNode,o=p.get(e)||0;o||(e.addEventListener("focus",b,F),e.addEventListener("blur",b,F)),p.set(e,o+1),++L==1&&(k().addEventListener("focus",C),I=ue(()=>{R(d.modalityDetected.value,!0)}))}function ne(t){const e=t.rootNode;if(p.has(e)){const o=p.get(e);o>1?p.set(e,o-1):(e.removeEventListener("focus",b,F),e.removeEventListener("blur",b,F),p.delete(e))}--L||(k().removeEventListener("focus",C),I&&(I(),I=null),clearTimeout(g),clearTimeout(m))}function A(t,e,o,c){N(t,e),j(o.subject,e,c),f=e}function re(t){const e=[];return u.forEach((o,c)=>{(c===t||o.checkChildren&&c.contains(t))&&e.push([c,o])}),e}return Y(()=>u.forEach((t,e)=>D(e))),{monitor:W,stopMonitoring:D,focusVia:J}}const Se=$(Le);export{Se as u};
